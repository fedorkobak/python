
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Features names out &#8212; Knowledge base</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'sklearn/dataset_transformations/features_names_out';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="One hot encoder" href="one_hot_encoder.html" />
    <link rel="prev" title="Specific processing for column" href="columns_transformer.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Knowledge base</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    <no title>
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../basics/syntax.html">Syntax</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../basics/syntax/operators.html">Operators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../basics/syntax/operators/order.html">Order</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../basics/syntax/keywords.html">Keywords</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../basics/syntax/keywords/in.html">Is in array (in)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../basics/syntax/keywords/yield.html">yield</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../basics/syntax/functions.html">Functions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../basics/syntax/functions/parameters.html">Parameters</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../basics/syntax/oop.html">OOP</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../basics/syntax/oop/interface.html">Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../basics/syntax/oop/class_method.html">Class method</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../basics/syntax/imports.html">Imports</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../basics/syntax/imports/sys_path.html">sys.path list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../basics/syntax/imports/from_package_import_all.html"><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">&lt;package&gt;</span> <span class="pre">import</span> <span class="pre">*</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../basics/syntax/imports/searching_module.html">Searching module</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/syntax/exceptions.html">Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/syntax/decorators.html">Decorators</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../basics/datatypes.html">Data types</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../basics/datatypes/basic.html">Basic</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../basics/datatypes/basic/str.html">str</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../basics/datatypes/basic/list.html">list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../basics/datatypes/basic/dict.html">dict</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../basics/datatypes/basic/set.html">set</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/datatypes/datetime.html">Datetime</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../basics/files_folders.html">Files &amp; folders</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../basics/files_folders/pathlib.html">Pathlib</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../basics/unittest.html">Unittest</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../basics/unittest/run_tests.html">Run tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/unittest/run_before_after.html">Run code before/after</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/unittest/check_error.html">Check error (assertRaises)</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../basics/unittest/mocking.html">Mocking</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../basics/unittest/mocking/call_details.html">Call details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../basics/unittest/mocking/syntax.html">Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../basics/unittest/mocking/patch.html">Patch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../basics/unittest/mocking/raising_errors.html">Raising errors</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../basics/logging.html">Logging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../basics/logging/loggers.html">Loggers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/logging/handlers.html">Handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/logging/filters.html">Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/logging/configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/logging/exception_information.html">Exceptions information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/logging/logging_to_file.html">Logging to file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/logging/logger_handler_level.html">Logger/Handler level</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/logging/root_logger.html">Root logger</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../basics/data_classes.html">Data class</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../basics/cli_arguments.html">CLI arguments</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../basics/cli_arguments/argparse.html">Library <code class="docutils literal notranslate"><span class="pre">argparse</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/cli_arguments/manually.html">Manually</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../basics/packages.html">Packages</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../basics/packages/pip.html">PIP</a></li>




<li class="toctree-l2"><a class="reference internal" href="../../basics/packages/pyproject_toml.html">Pyproject.toml</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../basics/interpreter.html">Interpreter</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../basics/interpreter/build.html">Build</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../packages.html">Packages</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../packages/collections.html"><code class="docutils literal notranslate"><span class="pre">collections</span></code> library</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/numpy.html">Numpy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/numpy/norm.html">Norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/numpy/array_splitting.html">Array splitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/numpy/apply_along_axis.html">Apply along axis</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../packages/excel_export.html">To excel import</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/zipfile.html">Zipfile</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/zipfile/extraction.html">Extraction</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/jupyter.html">Jupyter</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../packages/jupyter/ipython.html">IPython</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../packages/jupyter/ipython/syntax.html">Syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../packages/jupyter/ipython/reloading_modules.html">Reload modules</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/jupyter/jupyter_client.html">Jupyter client</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../packages/jinja.html">Jinja</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/docker_sdk.html">Docker SDK</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/docker_sdk/containers.html">Containers</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../packages/multi_threads.html">Multithreads in python</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/multiprocessing.html">Multiprocessing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/multiprocessing/pool.html">Pool</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/transformers.html">Transformers</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/transformers/pipeline.html">Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/transformers/tokenizer.html">Tokenizer</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../packages/apscheduler.html">APScheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../packages/hashlib.html">Hashlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../packages/selenium.html">Selenium</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/ranx.html">Ranx</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/ranx/entry_queries_documents.html">Queries documents entry</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../packages/tqdm.html">TQDM</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/redis.html">Redis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/redis/redis_client.html">Redis client</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../packages/surprise.html">Surprise</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/matplotlib.html">Matplotlib</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/matplotlib/table_in_matplotlib.html">matplotlib tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/matplotlib/gif_creation.html">Gif creation</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/airflow.html">Airflow</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/airflow/run_airflow.html">Run airflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/airflow/tutorial_dag.html">Tutorial DAG</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/geopy.html">Geopy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/geopy/distances.html">Distances</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/geopy/request.html">Request</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/type_annotations.html">Type annotations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/type_annotations/complex_types.html">Complex types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/type_annotations/function_annotations.html">Function annotations</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../packages/socket.html">Socket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../packages/requests.html">Requests</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/mlflow.html">MLflow</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/mlflow/example_of_use.html">Example of usе</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/mlflow/deploy.html">Deploy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/mlflow/custom_model.html">Custom model</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/plotly.html">Plotly</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/plotly/hovers.html">Hovers</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../packages/plotly/dragmode.html">Dragmode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/plotly/color_from_scheme.html">Color from scheme</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/dash.html">Dash</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/dash/callbacks.html">Callbacks</a></li>





<li class="toctree-l3"><a class="reference internal" href="../../packages/dash/components.html">Components</a></li>





<li class="toctree-l3"><a class="reference internal" href="../../packages/dash/select_clear_all.html">Select/Clear All</a></li>


<li class="toctree-l3"><a class="reference internal" href="../../packages/dash/multipage_applications.html">Multipage applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/dash/empty_figure.html">Empty figure</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/sqlalchemy.html">SQLAlchemy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../packages/sqlalchemy/metadata.html">Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/sqlalchemy/create_table.html">Create table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/sqlalchemy/query.html">Query</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/sqlalchemy/add_record.html">Add record</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/sqlalchemy/relations.html">Relations</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../packages/tkinter.html">Tkinter</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../packages/tkinter/widgets_overview.html">Widgets overview</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../packages/tkinter/widgets_overview/scrolling.html">Scrolling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../packages/tkinter/widgets_overview/treeview.html">Treeview</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/tkinter/pack.html">Pack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../packages/tkinter/change_elements_position.html">Change elements position</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Pandas</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../pandas/data_types.html">Data types</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../pandas/data_types/datetime.html">datetime</a></li>




<li class="toctree-l2"><a class="reference internal" href="../../pandas/data_types/columns_by_types.html">Columns by types</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../pandas/data_transformations.html">Data transformations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../pandas/data_transformations/groupby.html">Groupby</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../pandas/loc.html">&lt;DataFrame/Series&gt;.loc</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../pandas/data_visualisation.html">Data visualisation</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../pandas/styles.html">Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pandas/display_options.html">Display options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pandas/inline_columns_add.html">Inline column add (assign)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pandas/read_sql.html">pandas.read_sql</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Scikit-learn</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../dataset_transformations.html">Dataset transformations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="pipeline.html">Pipeline</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="pipeline/features_names.html">Features names</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="pipeline/memory_parameter.html"><code class="docutils literal notranslate"><span class="pre">memory</span></code> parameter(chacing)</a></li>
<li class="toctree-l2"><a class="reference internal" href="columns_transformer.html">Specific processing for column</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Features names out</a></li>
<li class="toctree-l2"><a class="reference internal" href="one_hot_encoder.html">One hot encoder</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="developing_transformer.html">Developing transformer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="developing_transformer/features_names_out.html">Feature names out</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="frozen_steps.html">Frozen steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimator_to_transformer.html">Estimator to transformer</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../grid_search_cv.html">Grid search CV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../saving_models.html">Saving models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../nearest_neighbors.html">Nearest neighbors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../nearest_neighbors/metric.html">Metric</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Torch</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../torch/tensor.html">Tensor</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../torch/tensor/creating_methods.html">Creating methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../torch/tensor/creating_methods/random_distributions.html">Random distributions</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../torch/tensor/dimentionality.html">Dimentionality</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../torch/tensor/dimentionality/reshape_like.html">Reshape like</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../torch/tensor/dimentionality/transpose_permute.html">Transpose/permute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../torch/tensor/dimentionality/add_dimention.html">Add dimention</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../torch/tensor/dimentionality/squeeze.html">Squeeze</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/tensor/concatenation_splitting.html">Concatenation/splitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/tensor/indexing.html">Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/tensor/broadcasting.html">Broadcasting</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../torch/loss_functions.html">Loss functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../torch/gradient.html">Gradient</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../torch/layers.html">Layers</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../torch/layers/linear.html">Linear</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/layers/dropout.html">Dropout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/layers/normalisation_layers.html">Normalisation layers</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../torch/layers/recurrent_layers.html">Recurrent layers</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../torch/layers/recurrent_layers/forward_input.html">Forward input</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/layers/flatten_unflatten.html">Flatten/unflatten</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../torch/managing_network.html">Managing network</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../torch/managing_network/sequential.html">Sequential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/managing_network/saving_model.html">Saving model</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../torch/devices.html">Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../torch/data_primitives.html">Data primitives</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../torch/vision.html">Vision</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../torch/vision/basic.html">Basic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/vision/augmentations.html">Augmentations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/vision/datasets.html">Datasets</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../torch/examples.html">Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../torch/examples/logistic_regression.html">Logistic regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/examples/multiclass_task.html">Multiclass task</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/examples/texts_classification.html">Text classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/examples/mnist.html">MNIST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/examples/symbols_classification.html">Symbols classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/examples/resnet_finetuning.html">Resnet finetuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/examples/cnn_classification.html">CNN classification</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../torch/examples/unet.html">Unet</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../torch/examples/unet/oxford_pet.html">Oxford pet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../torch/examples/unet/voc_segmentation.html">Voc segmentation</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/examples/gan.html">GAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../torch/examples/conditional_gan.html">Conditional GAN</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">FastAPI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../fastapi/run_application.html">Run application</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../fastapi/requests.html">Requests</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../fastapi/requests/request_object.html">Request object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fastapi/requests/pydantic_model.html">Pydantic model</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../fastapi/responses.html">Responses</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../fastapi/responses/json.html">JSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fastapi/responses/exceptions.html">Exceptions</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../fastapi/logging.html">Logging</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../fastapi/documentation.html">Documentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../fastapi/documentation/parameters.html">Parameters</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../fastapi/cache.html">Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fastapi/cors.html">CORS</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/fedorkobak/knowledge" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/sklearn/dataset_transformations/features_names_out.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Features names out</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defined-names">Defined names</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standartscaler"><code class="docutils literal notranslate"><span class="pre">StandartScaler</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polynomialfeatures"><code class="docutils literal notranslate"><span class="pre">PolynomialFeatures</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functiontransformer"><code class="docutils literal notranslate"><span class="pre">FunctionTransformer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-to-one"><code class="docutils literal notranslate"><span class="pre">"one-to-one"</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#callable">Callable</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#expected-inputs">Expected inputs</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#real-world-example">Real world example</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-output">Pandas output</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#whole-pipeline">Whole pipeline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-generation">Task generation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipeline">Pipeline</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-importances">Feature importances</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="features-names-out">
<h1>Features names out<a class="headerlink" href="#features-names-out" title="Link to this heading">#</a></h1>
<p>Having the ability to identify columns after applying transformations using different sklearn transformers is highly crucial. By default, sklearn transformers generate <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> outputs, lacking the column structure found in <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.</p>
<p>Fortunately, a solution to this problem has been introduced in <code class="docutils literal notranslate"><span class="pre">sklearn==1.1</span></code>. This solution involves the utilization of the <code class="docutils literal notranslate"><span class="pre">get_feature_names_out</span></code> method, which returns the feature names as values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>
<span class="n">header_template</span> <span class="o">=</span> <span class="s2">&quot;&lt;p style=&#39;font-size:17px&#39;&gt;</span><span class="si">{}</span><span class="s2">&lt;/p&gt;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">FunctionTransformer</span><span class="p">,</span>
    <span class="n">StandardScaler</span><span class="p">,</span>
    <span class="n">PolynomialFeatures</span><span class="p">,</span>
    <span class="n">OneHotEncoder</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_regression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">GradientBoostingRegressor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># this is frame with few numeric columns that</span>
<span class="c1"># is typically used for examples</span>
<span class="n">input_frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="sa">f</span><span class="s2">&quot;feature</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<section id="defined-names">
<h2>Defined names<a class="headerlink" href="#defined-names" title="Link to this heading">#</a></h2>
<p>There are converters that specify columns output names by themselves. In them you can simply call <code class="docutils literal notranslate"><span class="pre">get_features_names_out</span></code> in the trained object and the input names of the features will be returned. Some examples of such transformers:]</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">StandartScaler</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PolynomialFeatures</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CountVectorizer</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TfidfVectorizer</span></code>.</p></li>
</ul>
<section id="standartscaler">
<h3><code class="docutils literal notranslate"><span class="pre">StandartScaler</span></code><a class="headerlink" href="#standartscaler" title="Link to this heading">#</a></h3>
<p>So in the following example cell is for <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> - it just keeps names of the input array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Input dataframe&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">input_frame</span><span class="p">)</span>

<span class="n">my_scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;transform result&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">my_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">input_frame</span><span class="p">))</span>

<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;.get_features_names_out result&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">my_scaler</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style='font-size:17px'>Input dataframe</p></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature0</th>
      <th>feature1</th>
      <th>feature2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-14.280722</td>
      <td>31.497491</td>
      <td>6.184412</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-2.075748</td>
      <td>-8.914110</td>
      <td>-22.870986</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-5.787826</td>
      <td>-8.953351</td>
      <td>7.191721</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.867856</td>
      <td>-1.689381</td>
      <td>-0.849110</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.705764</td>
      <td>-2.525341</td>
      <td>9.514077</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><p style='font-size:17px'>transform result</p></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-1.75635129,  1.95850161,  0.53512169],
       [ 0.3693552 , -0.71405318, -1.91325944],
       [-0.27716716, -0.71664833,  0.62000351],
       [ 1.23036894, -0.23625764, -0.05756487],
       [ 0.43379432, -0.29154246,  0.81569911]])
</pre></div>
</div>
<div class="output text_html"><p style='font-size:17px'>.get_features_names_out result</p></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;feature0&#39;, &#39;feature1&#39;, &#39;feature2&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="polynomialfeatures">
<h3><code class="docutils literal notranslate"><span class="pre">PolynomialFeatures</span></code><a class="headerlink" href="#polynomialfeatures" title="Link to this heading">#</a></h3>
<p>The example we considered before was for <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> - it returns the same amount of features as it was in the input. But what if we consider transformers that output more columns than there were in the input?</p>
<p>Obviously <code class="docutils literal notranslate"><span class="pre">PolynomialFeatures</span></code> belongs to such transformers in that it returns products and powers of the original features. So the next cell prints out <code class="docutils literal notranslate"><span class="pre">get_feature_names</span></code> from <code class="docutils literal notranslate"><span class="pre">PolynomialFeatures</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poly_transformer</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">()</span>
<span class="n">poly_transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">input_frame</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Input frame&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">input_frame</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Output feature names&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">poly_transformer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style='font-size:17px'>Input frame</p></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature0</th>
      <th>feature1</th>
      <th>feature2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-14.280722</td>
      <td>31.497491</td>
      <td>6.184412</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-2.075748</td>
      <td>-8.914110</td>
      <td>-22.870986</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-5.787826</td>
      <td>-8.953351</td>
      <td>7.191721</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.867856</td>
      <td>-1.689381</td>
      <td>-0.849110</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.705764</td>
      <td>-2.525341</td>
      <td>9.514077</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><p style='font-size:17px'>Output feature names</p></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;1&#39;, &#39;feature0&#39;, &#39;feature1&#39;, &#39;feature2&#39;, &#39;feature0^2&#39;,
       &#39;feature0 feature1&#39;, &#39;feature0 feature2&#39;, &#39;feature1^2&#39;,
       &#39;feature1 feature2&#39;, &#39;feature2^2&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Everything is pretty simple - it writes the names of the inputs used in the product one by one and uses the <code class="docutils literal notranslate"><span class="pre">^</span></code> symbol to declare the power.</p>
<p>It seems that other transformers with such features will have something similar - quite simple, but not really customisable.</p>
</section>
</section>
<section id="functiontransformer">
<h2><code class="docutils literal notranslate"><span class="pre">FunctionTransformer</span></code><a class="headerlink" href="#functiontransformer" title="Link to this heading">#</a></h2>
<p>This transformer have a bit tricky behaviour of <code class="docutils literal notranslate"><span class="pre">get_feature_names_out</span></code> method.</p>
<p>You have to specify <code class="docutils literal notranslate"><span class="pre">feature_names_out</span></code>. It can be <code class="docutils literal notranslate"><span class="pre">&quot;one-to-one&quot;</span></code> or something callable. For both options I have examples below.</p>
<section id="one-to-one">
<h3><code class="docutils literal notranslate"><span class="pre">&quot;one-to-one&quot;</span></code><a class="headerlink" href="#one-to-one" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">one-to-one</span></code> simply causes <code class="docutils literal notranslate"><span class="pre">.get_feature_names_out</span></code> to return the feature names as they were in the input. The following example is sutitable for <code class="docutils literal notranslate"><span class="pre">dummy</span></code> transformer - the following example is suitable for the <code class="docutils literal notranslate"><span class="pre">dummy</span></code> transformer - it simply returns it’s input.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Input dataframe&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">input_frame</span><span class="p">)</span>

<span class="n">my_scaler</span> <span class="o">=</span> <span class="n">FunctionTransformer</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">X</span> <span class="p">:</span> <span class="n">X</span><span class="p">,</span>
    <span class="n">feature_names_out</span> <span class="o">=</span> <span class="s2">&quot;one-to-one&quot;</span>
<span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;transform result&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">my_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">input_frame</span><span class="p">))</span>

<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;.get_features_names_out result&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">my_scaler</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style='font-size:17px'>Input dataframe</p></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature0</th>
      <th>feature1</th>
      <th>feature2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-14.280722</td>
      <td>31.497491</td>
      <td>6.184412</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-2.075748</td>
      <td>-8.914110</td>
      <td>-22.870986</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-5.787826</td>
      <td>-8.953351</td>
      <td>7.191721</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.867856</td>
      <td>-1.689381</td>
      <td>-0.849110</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.705764</td>
      <td>-2.525341</td>
      <td>9.514077</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><p style='font-size:17px'>transform result</p></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature0</th>
      <th>feature1</th>
      <th>feature2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-14.280722</td>
      <td>31.497491</td>
      <td>6.184412</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-2.075748</td>
      <td>-8.914110</td>
      <td>-22.870986</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-5.787826</td>
      <td>-8.953351</td>
      <td>7.191721</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.867856</td>
      <td>-1.689381</td>
      <td>-0.849110</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.705764</td>
      <td>-2.525341</td>
      <td>9.514077</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><p style='font-size:17px'>.get_features_names_out result</p></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;feature0&#39;, &#39;feature1&#39;, &#39;feature2&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p><strong>Note</strong>: While the usefulness of <code class="docutils literal notranslate"><span class="pre">.get_feature_names_out</span></code> may not be apparent in the current case where a transformer returns a dataframe, it becomes valuable in more complex pipelines where it remembers feature names in a scikit-learn style. Its ability to retain names can be crucial in such scenarios, making it a useful feature to have.</p>
</section>
<section id="callable">
<h3>Callable<a class="headerlink" href="#callable" title="Link to this heading">#</a></h3>
<p>If you pass callable as argument to <code class="docutils literal notranslate"><span class="pre">feature_names_out</span></code> it will be called with <code class="docutils literal notranslate"><span class="pre">.get_feature_names_out</span></code>. It should instance of <code class="docutils literal notranslate"><span class="pre">FunctionTransformer</span></code> that called method and input array of input features.</p>
<section id="expected-inputs">
<h4>Expected inputs<a class="headerlink" href="#expected-inputs" title="Link to this heading">#</a></h4>
<p>Let’s study what is passed to the specified in <code class="docutils literal notranslate"><span class="pre">feature_names_out</span></code> funcion on the example. Let’s just try to substitute such a function that will return its own input elements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_transformer</span> <span class="o">=</span> <span class="n">FunctionTransformer</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">),</span>
    <span class="c1"># here is just function that returns</span>
    <span class="c1"># it&#39;s inputs to check what they actualy</span>
    <span class="c1"># are</span>
    <span class="n">feature_names_out</span><span class="o">=</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">transformer</span><span class="p">,</span> <span class="n">input_features</span><span class="p">:</span> \
        <span class="p">(</span><span class="n">transformer</span><span class="p">,</span> <span class="n">input_features</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">my_transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">input_frame</span><span class="p">)</span>
<span class="n">features_output</span> <span class="o">=</span> <span class="n">my_transformer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;First argument - transformer itself&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">features_output</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Check if first input of the feature_names_out&quot;</span>
    <span class="s2">&quot;really initial transformer - &quot;</span><span class="p">,</span>
    <span class="n">features_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">my_transformer</span>
<span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Second argument - input feature names&quot;</span><span class="p">)))</span>
<span class="n">features_output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style='font-size:17px'>First argument - transformer itself</p></div><div class="output text_html"><style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>FunctionTransformer(feature_names_out=&lt;function &lt;lambda&gt; at 0x726f0464c1f0&gt;,
                    func=&lt;function &lt;lambda&gt; at 0x726f0464c160&gt;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;FunctionTransformer<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.4/modules/generated/sklearn.preprocessing.FunctionTransformer.html">?<span>Documentation for FunctionTransformer</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>FunctionTransformer(feature_names_out=&lt;function &lt;lambda&gt; at 0x726f0464c1f0&gt;,
                    func=&lt;function &lt;lambda&gt; at 0x726f0464c160&gt;)</pre></div> </div></div></div></div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Check if first input of the feature_names_outreally initial transformer -  True
</pre></div>
</div>
<div class="output text_html"><p style='font-size:17px'>Second argument - input feature names</p></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;feature0&#39;, &#39;feature1&#39;, &#39;feature2&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="real-world-example">
<h4>Real world example<a class="headerlink" href="#real-world-example" title="Link to this heading">#</a></h4>
<p>Here is an example of how the tools we are considering might be used in the real world.</p>
<p>Suppose you need to build a transformer that returns squares and cubes of each feature of the input array. And the result features should have names <code class="docutils literal notranslate"><span class="pre">&lt;inputname&gt;</span> <span class="pre">square</span></code> for squares and <code class="docutils literal notranslate"><span class="pre">&lt;inputname&gt;</span> <span class="pre">cube</span></code> for cubes.</p>
<p>This can be achieved with the following code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_transformer</span> <span class="o">=</span> <span class="n">FunctionTransformer</span><span class="p">(</span>
    <span class="c1"># iterates over all input features</span>
    <span class="c1"># and returns square and cube of them</span>
    <span class="k">lambda</span> <span class="n">X</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">[[</span><span class="n">col</span><span class="p">]]</span><span class="o">**</span><span class="n">power</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X</span>
            <span class="k">for</span> <span class="n">power</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="p">],</span> 
        <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">),</span>
    <span class="c1"># iterates over input features anmes</span>
    <span class="c1"># and for each creates pair of square</span>
    <span class="c1"># and cube name</span>
    <span class="n">feature_names_out</span> <span class="o">=</span> <span class="p">(</span>
        <span class="k">lambda</span> <span class="n">transformer</span><span class="p">,</span> <span class="n">input_features</span><span class="p">:</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">power_str</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">input_features</span>
            <span class="k">for</span> <span class="n">power_str</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;square&quot;</span><span class="p">,</span> <span class="s2">&quot;cubic&quot;</span><span class="p">]</span>
        <span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Input dataframe&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">input_frame</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;transform output&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">my_transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">input_frame</span><span class="p">))</span>

<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;.get_feature_names_out&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">my_transformer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style='font-size:17px'>Input dataframe</p></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature0</th>
      <th>feature1</th>
      <th>feature2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-14.280722</td>
      <td>31.497491</td>
      <td>6.184412</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-2.075748</td>
      <td>-8.914110</td>
      <td>-22.870986</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-5.787826</td>
      <td>-8.953351</td>
      <td>7.191721</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.867856</td>
      <td>-1.689381</td>
      <td>-0.849110</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.705764</td>
      <td>-2.525341</td>
      <td>9.514077</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><p style='font-size:17px'>transform output</p></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 2.03939021e+02, -2.91239646e+03,  9.92091924e+02,
         3.12484062e+04,  3.82469580e+01,  2.36534965e+02],
       [ 4.30872906e+00, -8.94383501e+00,  7.94613487e+01,
        -7.08327166e+02,  5.23081992e+02, -1.19634008e+04],
       [ 3.34989304e+01, -1.93885982e+02,  8.01624893e+01,
        -7.17722882e+02,  5.17208506e+01,  3.71961926e+02],
       [ 8.22459681e+00,  2.35869576e+01,  2.85400873e+00,
        -4.82150860e+00,  7.20987968e-01, -6.12198168e-01],
       [ 2.90962976e+00, -4.96314078e+00,  6.37734601e+00,
        -1.61049719e+01,  9.05176701e+01,  8.61192125e+02]])
</pre></div>
</div>
<div class="output text_html"><p style='font-size:17px'>.get_feature_names_out</p></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;feature0 square&#39;, &#39;feature0 cubic&#39;, &#39;feature1 square&#39;,
       &#39;feature1 cubic&#39;, &#39;feature2 square&#39;, &#39;feature2 cubic&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="pandas-output">
<h4>Pandas output<a class="headerlink" href="#pandas-output" title="Link to this heading">#</a></h4>
<p>Ideally, if the function specified in FunctionTransfomer returns pandas.DataFrame, then the columns that <code class="docutils literal notranslate"><span class="pre">get_feature_names_out</span></code> returns should be automatically applied to the result. But if you try to adapt the previous example, the result is an error. Just like in the following cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_transformer</span> <span class="o">=</span> <span class="n">FunctionTransformer</span><span class="p">(</span>
    <span class="c1"># iterates over all input features</span>
    <span class="c1"># and returns square and cube of them</span>
    <span class="k">lambda</span> <span class="n">X</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">power</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">:</span> <span class="n">X</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">**</span><span class="n">power</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X</span>
            <span class="k">for</span> <span class="n">power</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">),</span>
    <span class="c1"># iterates over input features anmes</span>
    <span class="c1"># and for each creates pair of square</span>
    <span class="c1"># and cube name</span>
    <span class="n">feature_names_out</span> <span class="o">=</span> <span class="p">(</span>
        <span class="k">lambda</span> <span class="n">transformer</span><span class="p">,</span> <span class="n">input_features</span><span class="p">:</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">power</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">input_features</span>
            <span class="k">for</span> <span class="n">power</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Input dataframe&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">input_frame</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Output dataframe&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">my_transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">input_frame</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">header_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;get_features_names_out&quot;</span><span class="p">)))</span>
<span class="n">display</span><span class="p">(</span><span class="n">my_transformer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p style='font-size:17px'>Input dataframe</p></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature0</th>
      <th>feature1</th>
      <th>feature2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-14.280722</td>
      <td>31.497491</td>
      <td>6.184412</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-2.075748</td>
      <td>-8.914110</td>
      <td>-22.870986</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-5.787826</td>
      <td>-8.953351</td>
      <td>7.191721</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.867856</td>
      <td>-1.689381</td>
      <td>-0.849110</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.705764</td>
      <td>-2.525341</td>
      <td>9.514077</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><p style='font-size:17px'>Output dataframe</p></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature0^2</th>
      <th>feature0^3</th>
      <th>feature1^2</th>
      <th>feature1^3</th>
      <th>feature2^2</th>
      <th>feature2^3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>203.939021</td>
      <td>-2912.396463</td>
      <td>992.091924</td>
      <td>31248.406225</td>
      <td>38.246958</td>
      <td>236.534965</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.308729</td>
      <td>-8.943835</td>
      <td>79.461349</td>
      <td>-708.327166</td>
      <td>523.081992</td>
      <td>-11963.400814</td>
    </tr>
    <tr>
      <th>2</th>
      <td>33.498930</td>
      <td>-193.885982</td>
      <td>80.162489</td>
      <td>-717.722882</td>
      <td>51.720851</td>
      <td>371.961926</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8.224597</td>
      <td>23.586958</td>
      <td>2.854009</td>
      <td>-4.821509</td>
      <td>0.720988</td>
      <td>-0.612198</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.909630</td>
      <td>-4.963141</td>
      <td>6.377346</td>
      <td>-16.104972</td>
      <td>90.517670</td>
      <td>861.192125</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><p style='font-size:17px'>get_features_names_out</p></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;feature0^2&#39;, &#39;feature0^3&#39;, &#39;feature1^2&#39;, &#39;feature1^3&#39;,
       &#39;feature2^2&#39;, &#39;feature2^3&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p><strong>Note</strong> that the columns of the output dataframe should be the same as the columns provided by <code class="docutils literal notranslate"><span class="pre">features_names_out</span></code>. The following cells show the error you would get otherwise. There is an <a class="reference external" href="https://github.com/scikit-learn/scikit-learn/issues/28780">issue</a> about this in the <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> github repository, check it out - something may have changed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_transformer</span> <span class="o">=</span> <span class="n">FunctionTransformer</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">X</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">power</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">:</span> <span class="n">X</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">**</span><span class="n">power</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X</span>
            <span class="k">for</span> <span class="n">power</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">),</span>
    <span class="n">feature_names_out</span> <span class="o">=</span> <span class="p">(</span>
        <span class="k">lambda</span> <span class="n">transformer</span><span class="p">,</span> <span class="n">input_features</span><span class="p">:</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;out_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">power</span><span class="si">}</span><span class="s2">&quot;</span> <span class="c1"># it will differ from output of function</span>
            <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">input_features</span>
            <span class="k">for</span> <span class="n">power</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">my_transformer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">input_frame</span><span class="p">)</span>
<span class="c1"># transform causes a error</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">my_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_frame</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exception text:&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception text: The output generated by `func` have different column names than the ones provided by `get_feature_names_out`. Got output with columns names: [&#39;feature0^2&#39;, &#39;feature0^3&#39;, &#39;feature1^2&#39;, &#39;feature1^3&#39;, &#39;feature2^2&#39;, &#39;feature2^3&#39;] and `get_feature_names_out` returned: [&#39;out_feature0^2&#39;, &#39;out_feature0^3&#39;, &#39;out_feature1^2&#39;, &#39;out_feature1^3&#39;, &#39;out_feature2^2&#39;, &#39;out_feature2^3&#39;]. The column names can be overridden by setting `set_output(transform=&#39;pandas&#39;)` or `set_output(transform=&#39;polars&#39;)` such that the column names are set to the names provided by `get_feature_names_out`.
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="whole-pipeline">
<h2>Whole pipeline<a class="headerlink" href="#whole-pipeline" title="Link to this heading">#</a></h2>
<p>All the tools described above are useful only if we use them in a full pipeline of data transformations. It’s easy to just define column names for output if you’re using a single transformer. It’s harder if you use a series of transformers connected by <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> or <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code>.</p>
<p>In this section we would try to build a whole pipeline with the model and check how easy it would be to explore properties of the model having feature names.</p>
<section id="task-generation">
<h3>Task generation<a class="headerlink" href="#task-generation" title="Link to this heading">#</a></h3>
<p>Let’s take a synthetic regression task as an example. It would have some informative features mixed with useless ones. It would have some categorical features and some numerical features to have reason to apply <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> and <code class="docutils literal notranslate"><span class="pre">OneHotEncoding</span></code> to data. Also it would have a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> function that stores some useful information in it’s months to try <code class="docutils literal notranslate"><span class="pre">FunctionTransformer</span></code> for extracting different components of the date.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="n">n_features</span><span class="o">=</span><span class="mi">20</span>
<span class="n">n_samples</span><span class="o">=</span><span class="mi">1000</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_regression</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span> 
    <span class="n">n_informative</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">categorise_feature</span><span class="p">(</span><span class="n">X</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function that allows to convert numerical</span>
<span class="sd">    characteristics into categorical characteristics </span>
<span class="sd">    with Latin alphabet. It uses a random number </span>
<span class="sd">    of bins.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : np.array</span>
<span class="sd">        input feature;</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    out : np.array</span>
<span class="sd">        same size feature with values</span>
<span class="sd">        encoded as symbols of Latin alphabet.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">quantiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">))[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">quantiles</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> 
        <span class="nb">range</span><span class="p">(</span>
            <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">),</span> 
            <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">quantiles</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="p">)</span>
    <span class="p">]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="nb">bin</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="n">res</span><span class="p">[</span><span class="n">X</span><span class="o">&gt;</span><span class="nb">bin</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>

    <span class="k">return</span> <span class="n">res</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="sa">f</span><span class="s2">&quot;feature </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:(</span>
        <span class="n">X</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="k">else</span> 
        <span class="n">categorise_feature</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
    <span class="p">)</span> 
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="p">})</span>

<span class="c1"># constructing month number which</span>
<span class="c1"># correlate with target</span>
<span class="c1"># but it have to have some noise</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span>
    <span class="p">(</span><span class="n">months</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">months</span><span class="p">))</span><span class="o">/</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">months</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">months</span><span class="p">))</span>
<span class="p">)</span><span class="o">*</span><span class="mi">12</span><span class="p">)</span>
<span class="n">months</span><span class="p">[</span><span class="n">months</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># constructing date feature that using</span>
<span class="c1"># where only month can be useful in</span>
<span class="c1"># the prediction task</span>
<span class="n">date_feature</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;day&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">),</span>
        <span class="s2">&quot;month&quot;</span> <span class="p">:</span> <span class="n">months</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="s2">&quot;year&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1980</span><span class="p">,</span> <span class="mi">2024</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="p">})</span>
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">datetime</span><span class="p">(</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span> 
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">],</span> 
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;day&quot;</span><span class="p">]</span>
        <span class="p">),</span> 
        <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">X</span><span class="p">[</span><span class="s2">&quot;date feature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">date_feature</span>
<span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature 0</th>
      <th>feature 1</th>
      <th>feature 2</th>
      <th>feature 3</th>
      <th>feature 4</th>
      <th>feature 5</th>
      <th>feature 6</th>
      <th>feature 7</th>
      <th>feature 8</th>
      <th>feature 9</th>
      <th>...</th>
      <th>feature 11</th>
      <th>feature 12</th>
      <th>feature 13</th>
      <th>feature 14</th>
      <th>feature 15</th>
      <th>feature 16</th>
      <th>feature 17</th>
      <th>feature 18</th>
      <th>feature 19</th>
      <th>date feature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.617891</td>
      <td>c</td>
      <td>d</td>
      <td>b</td>
      <td>c</td>
      <td>a</td>
      <td>a</td>
      <td>b</td>
      <td>-196.739681</td>
      <td>e</td>
      <td>...</td>
      <td>-47.603852</td>
      <td>d</td>
      <td>33.356150</td>
      <td>a</td>
      <td>a</td>
      <td>-122.367117</td>
      <td>-6.721474</td>
      <td>c</td>
      <td>e</td>
      <td>1986-09-04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-70.125115</td>
      <td>a</td>
      <td>a</td>
      <td>c</td>
      <td>a</td>
      <td>a</td>
      <td>b</td>
      <td>b</td>
      <td>-10.601175</td>
      <td>f</td>
      <td>...</td>
      <td>-71.627628</td>
      <td>a</td>
      <td>-101.127295</td>
      <td>e</td>
      <td>b</td>
      <td>-91.372820</td>
      <td>4.377953</td>
      <td>c</td>
      <td>d</td>
      <td>1993-08-14</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-20.582671</td>
      <td>c</td>
      <td>a</td>
      <td>c</td>
      <td>d</td>
      <td>c</td>
      <td>b</td>
      <td>b</td>
      <td>200.739023</td>
      <td>d</td>
      <td>...</td>
      <td>-16.353255</td>
      <td>a</td>
      <td>40.661435</td>
      <td>a</td>
      <td>a</td>
      <td>-96.068509</td>
      <td>0.313386</td>
      <td>b</td>
      <td>g</td>
      <td>1991-08-07</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-15.356126</td>
      <td>c</td>
      <td>a</td>
      <td>d</td>
      <td>c</td>
      <td>c</td>
      <td>d</td>
      <td>b</td>
      <td>-153.459105</td>
      <td>b</td>
      <td>...</td>
      <td>26.679386</td>
      <td>e</td>
      <td>120.183909</td>
      <td>f</td>
      <td>b</td>
      <td>16.846444</td>
      <td>-2.223026</td>
      <td>a</td>
      <td>f</td>
      <td>2013-09-02</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-63.181240</td>
      <td>a</td>
      <td>g</td>
      <td>a</td>
      <td>b</td>
      <td>b</td>
      <td>d</td>
      <td>b</td>
      <td>-108.291832</td>
      <td>b</td>
      <td>...</td>
      <td>-17.332633</td>
      <td>f</td>
      <td>21.126076</td>
      <td>b</td>
      <td>b</td>
      <td>-147.533723</td>
      <td>-2.960036</td>
      <td>b</td>
      <td>h</td>
      <td>2019-09-16</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div></div></div>
</div>
</section>
<section id="pipeline">
<h3>Pipeline<a class="headerlink" href="#pipeline" title="Link to this heading">#</a></h3>
<p>As planned:</p>
<ul class="simple">
<li><p>Numeric features go throgh the <code class="docutils literal notranslate"><span class="pre">StandartScaler</span></code> with the name <code class="docutils literal notranslate"><span class="pre">numeric_transformer</span></code>;</p></li>
<li><p>Categorial features go throgh the <code class="docutils literal notranslate"><span class="pre">OneHotEncoding</span></code> with the name <code class="docutils literal notranslate"><span class="pre">object_transformer</span></code>;</p></li>
<li><p>And there is <code class="docutils literal notranslate"><span class="pre">FunctionTransformer</span></code> for <code class="docutils literal notranslate"><span class="pre">date</span> <span class="pre">feature</span></code> which extracts <code class="docutils literal notranslate"><span class="pre">day</span></code>, <code class="docutils literal notranslate"><span class="pre">month</span></code> and <code class="docutils literal notranslate"><span class="pre">year</span></code>, and gives corresponding names to the output.</p></li>
</ul>
<p>And there is a gradient boosting as model of the pipeline.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">object_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="s2">&quot;O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">date_time_transformer</span> <span class="o">=</span> <span class="n">FunctionTransformer</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;day&quot;</span> <span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
        <span class="s2">&quot;month&quot;</span> <span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
        <span class="s2">&quot;year&quot;</span> <span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
    <span class="p">}),</span>
    <span class="n">feature_names_out</span> <span class="o">=</span> <span class="p">(</span>
        <span class="k">lambda</span> <span class="n">tr</span><span class="p">,</span> <span class="n">inp</span><span class="p">:</span> 
        <span class="p">[</span><span class="s2">&quot;day&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">my_transformer</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;numeric_transformer&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">numeric_features</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;object_transformer&quot;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(),</span> <span class="n">object_features</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;datetime_transformer&quot;</span><span class="p">,</span> <span class="n">date_time_transformer</span><span class="p">,</span> <span class="s2">&quot;date feature&quot;</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">pl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;transformer&quot;</span><span class="p">,</span> <span class="n">my_transformer</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="p">])</span>
<span class="n">pl</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="feature-importances">
<h3>Feature importances<a class="headerlink" href="#feature-importances" title="Link to this heading">#</a></h3>
<p>Now this is what we’re all about. Now, let’s say that for reasons of optimising the algorithm we need to get variables that are not important for decision making. Gradient Boosting has <code class="docutils literal notranslate"><span class="pre">feature_importances_</span></code> for such purposes. But as you can see in the following cell, it is completely useless in the raw view.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">feature_importances_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2.47289298e-01, 2.38966681e-03, 6.15139879e-03, 3.53447551e-03,
       2.19951240e-03, 2.66402624e-01, 2.55979225e-02, 3.09790962e-04,
       0.00000000e+00, 0.00000000e+00, 3.75741598e-04, 0.00000000e+00,
       3.18557550e-04, 3.17112646e-04, 1.10644546e-04, 0.00000000e+00,
       1.78952666e-05, 6.46668227e-05, 1.86142792e-04, 0.00000000e+00,
       0.00000000e+00, 6.72328698e-05, 3.92795818e-02, 6.38885869e-03,
       0.00000000e+00, 2.91394844e-03, 3.50356952e-02, 0.00000000e+00,
       2.84008478e-04, 7.04788804e-05, 0.00000000e+00, 2.07779652e-04,
       3.93672142e-06, 1.13211846e-04, 3.99649454e-04, 3.79798469e-04,
       7.83053217e-02, 0.00000000e+00, 5.75348690e-02, 1.12977377e-03,
       9.39223697e-05, 0.00000000e+00, 0.00000000e+00, 2.15973947e-05,
       6.86836029e-04, 9.17177949e-04, 1.04394168e-03, 7.12935589e-05,
       0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
       4.43880249e-02, 8.11633707e-03, 2.73218256e-04, 0.00000000e+00,
       7.81992544e-03, 4.35630916e-02, 2.05404571e-04, 4.53438250e-04,
       6.85197453e-04, 0.00000000e+00, 2.29351672e-02, 0.00000000e+00,
       1.39065136e-02, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
       0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
       0.00000000e+00, 9.06998067e-04, 7.62847932e-02, 2.47526727e-04])
</pre></div>
</div>
</div>
</div>
<p>The only conclusion I can draw from this bunch of numbers is that months is just an infomative feature extracted from <code class="docutils literal notranslate"><span class="pre">date</span> <span class="pre">feature</span></code> - its just because I remember that it should be a prelast feature.</p>
<p>This is where <code class="docutils literal notranslate"><span class="pre">get_feature_names_out</span></code> really helps. If we call it for <code class="docutils literal notranslate"><span class="pre">ColumnsTransformer</span></code> it’ll call it for each of its transformers and return in the format <code class="docutils literal notranslate"><span class="pre">&lt;transformer_name&gt;__&lt;outputs</span> <span class="pre">of</span> <span class="pre">get_feature_names_out</span> <span class="pre">for</span> <span class="pre">transformers&gt;</span></code>. So now we can map feature to any number and preform any visualisation you like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(),</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">feature_importances_</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d7b168331d373503f50d1ddeb451b65bad9f2ae4bc0e05f538d50318bc955e8d.png" src="../../_images/d7b168331d373503f50d1ddeb451b65bad9f2ae4bc0e05f538d50318bc955e8d.png" />
</div>
</div>
<p>So now it’s much easier to conclude that useful features here are: 0,16,17,4,7,14,18 and months from <code class="docutils literal notranslate"><span class="pre">date</span> <span class="pre">feature</span></code>. So it’s namy features to exclude and as a result optimise the model.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./sklearn/dataset_transformations"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="columns_transformer.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Specific processing for column</p>
      </div>
    </a>
    <a class="right-next"
       href="one_hot_encoder.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">One hot encoder</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defined-names">Defined names</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standartscaler"><code class="docutils literal notranslate"><span class="pre">StandartScaler</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polynomialfeatures"><code class="docutils literal notranslate"><span class="pre">PolynomialFeatures</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functiontransformer"><code class="docutils literal notranslate"><span class="pre">FunctionTransformer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-to-one"><code class="docutils literal notranslate"><span class="pre">"one-to-one"</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#callable">Callable</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#expected-inputs">Expected inputs</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#real-world-example">Real world example</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-output">Pandas output</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#whole-pipeline">Whole pipeline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-generation">Task generation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipeline">Pipeline</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-importances">Feature importances</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Fedor Kobak
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>